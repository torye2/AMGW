<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>공지사항 목록</title>
<link rel="stylesheet" href="../css/Notice_L.css" />
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" th:href="@{/css/styles.css}" />
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />
</head>
<body>
	<div th:replace="~{fragments/header :: siteHeader}"></div>
	<div class="container grid grid-cols-1 md:grid-cols-[240px,1fr] gap-4 sm:gap-6 py-4">
	<div th:replace="~{fragments/sidebar :: siteSidebar}"></div>
		<div class="Notice_section">
			<div>
				<div class="Notice_Ltopbox">
					<div><h1>공지사항</h1></div>
				</div>
				<div class="Notice_search">
					<div class="Notice_searchbox">
					    <form th:action="@{/Notice_L}" method="get" id="searchForm">
					    	<select name="searchType">
					    		<option value="title" th:selected="${searchType == 'title'}">제목</option>
					    		<option value="content" th:selected="${searchType == 'content'}">내용</option>
					    	</select>
					        <input type="text" name="keyword" th:value="${keyword}" placeholder="검색어를 입력해주세요" />
					        <button type="submit">검색</button>
					    </form>
					</div>
				</div>
			</div>
			<div class="Notice_Lbottonbox">
				<form th:action="@{/Notice_Delete}" method="post">
					<div id="Notice_LbigBox">
						<table class="Notice_LBox">
							<thead class="Notice_headbox">
								<tr id="Notice_L-head">
									<td th:if="${me.roles.contains('ROLE_ADMIN')}" id="List_CheckBox"><input type="checkbox" id="checkAll"></td>
									<td id="List_number">순서</td>
									<td id="List_title">제목</td>
									<td id="user_id">작성자</td>
									<td id="reg_Creationdate">작성날짜</td>
									<td id="check_count">조회수</td>
								</tr>	
							</thead>
							<tbody>
								<tr th:each="notice, stat : ${notices}" class="Notice_L-body">
									<td th:if="${me.roles.contains('ROLE_ADMIN')}"><input type="checkbox" name="noticeIds" th:value="${notice.notice_id}"/></td>
									
									<td th:if="${notice.important}" class="important-cell"><p>중요!</p></td>
									<td th:unless="${notice.important}" th:text="${stat.index + 1}" id="Number_notice"></td>
									
									<td id="title_notice">
										<a th:href="@{/Notice_D/{id}(id=${notice.notice_id})}" th:text="${notice.notice_title}"></a>
									</td>
									
									<td th:text="${notice.username}" id="userId_notice"></td>
									<td th:text="${#dates.format(notice.registration_time, 'yyyy-MM-dd')}" id="time_notice"></td>
									<td th:text="${notice.notice_count}" id="count_notice"></td>
								</tr>
								
								<tr th:if="${#lists.isEmpty(notices)}">
									<td colspan="6" class="Notice_not">등록된 공지사항이 없습니다.</td>
								</tr>
							</tbody>
						</table>
					</div>	
					<div class="pagination">
						<span th:if="${currentPage > 1}">
							<a th:href="@{/Notice_L(page=${currentPage - 1}, pageSize=10)}" id="Notice_Previous">이전</a>
						</span>
						
						<span th:each="pageNum : ${#numbers.sequence(1, totalPages)}" id="Notice_page-number">
							<a th:href="@{/Notice_L(page=${pageNum}, pageSize=10)}"
							   th:text="${pageNum}"
							   th:classappend="${pageNum == currentPage} ? 'active' : ''"></a>
						</span>
						
						<span th:if="${currentPage < totalPages}">
							<a th:href="@{/Notice_L(page=${currentPage + 1}, pageSize=10)}"id="Notice_Next">다음</a>
						</span>
					</div>
						
					<div class="Notice_Lbtn"> 
						<button th:if="${me.roles.contains('ROLE_ADMIN')}" type="button" onclick="location.href='/Notice_W'">글쓰기</button>
						<button th:if="${me.roles.contains('ROLE_ADMIN')}" id="fix" type="button">수정</button>
						<button th:if="${me.roles.contains('ROLE_ADMIN')}" id="delete" type="submit">삭제</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	<script src="/JS/Notice_L.js"></script>
</body>
</html>